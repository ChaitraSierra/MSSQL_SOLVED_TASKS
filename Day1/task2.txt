
SELECT
    CustomerId,
    AVG(EnergyConsumed) AS AvgEnergyConsumed,
    MAX(EnergyConsumed) AS MaxEnergyConsumed
FROM SmartMeterReadings
WHERE YEAR(ReadingDateTime) = YEAR(GETDATE())
GROUP BY CustomerId;

